# setup a devstack including stack user, reference https://docs.openstack.org/devstack/latest/
git clone https://git.openstack.org/openstack-dev/devstack
cd devstack/
# create local.conf, reference https://github.com/sjamgade/monasca-autoscaling/blob/master/environment/local.conf
./stack.sh
vi /etc/monasca/monasca-api.conf
# add monasca-agent to delegate_authorized_roles
sudo systemctl restart apache2
/opt/monasca-agent/bin/pip install monasca-agent[libvirt]
sudo /opt/monasca-agent/bin/monasca-setup -d libvirt
# set `vm_probation: 0` in /etc/monasca/agent/conf.d/libvirt.yaml

openstack security group delete testvm || :
openstack security group create --description testvm testvm
openstack security group rule create --protocol icmp testvm
openstack security group rule create --protocol tcp --dst-port 1:65535 testvm
openstack security group rule create --protocol udp --dst-port 1:65535 testvm

# copy public key do the snapshot host
# copy bash_history
